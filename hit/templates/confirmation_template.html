<!-- Bootstrap v3.0.3 -->
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://s3.amazonaws.com/mturk-public/bs30/css/bootstrap.min.css" rel="stylesheet" />
<section class="container" id="Other" style="margin-bottom:15px; padding: 10px 10px; font-family: sans-serif, Verdana, Geneva  ; color:#333333; font-size:1.0em;">
<style type="text/css">
    hr {
        color: #000000;
        background-color: #000000;
        height: 2px;
    }

    table,
    th,
    td {
        border: 1px solid black;
        border-collapse: collapse;
    }

    th,
    td {
        padding: 5px;
        text-align: left;
        table-layout: fixed;
        font-size: 15px;
    }

    .sentence {
        font-size: 16px;
    }

    .panel-heading {
        background-color: #a7eede !important;
        border: 0px solid;
    }

    .panel-primary {
        border-color: #FFFFFF;
        border: 0px solid #FFFFFF;
    }

    .emph {
        color: #EC407A;
    }

    .blue {
        color: #0000FF;
    }

    .red {
        color: #FF0000;
    }

    .instr {
        font-family: sans-serif, Verdana, Geneva;
        font-size: 15px;
        line-height: 20px;
        width: 88%;
    }
    .chat {text-align: right;}
    .option {text-align: right;}
    .user {text-align: left;}

    #slidecontainer {
        width: 100%;
        /* Width of the outside container */
        margin-bottom: 1cm;
    }

    .slider {
        -webkit-appearance: none;
        /* Override default CSS styles */
        appearance: none;
        width: 40%;
        /* Full-width */
        height: 10px;
        /* Specified height */
        background: #b4b4b4;
        /* Grey background */
        outline: none;
        /* Remove outline */
        opacity: 0.7;
        /* Set transparency (for mouse-over effects on hover) */
        -webkit-transition: .2s;
        /* 0.2 seconds transition on hover */
        transition: opacity .2s;
    }

    .slider2 {
        -webkit-appearance: none;
        /* Override default CSS styles */
        appearance: none;
        width: 40%;
        /* Full-width */
        height: 10px;
        /* Specified height */
        background: #b4b4b4;
        /* Grey background */
        outline: none;
        /* Remove outline */
        opacity: 0.7;
        /* Set transparency (for mouse-over effects on hover) */
        -webkit-transition: .2s;
        /* 0.2 seconds transition on hover */
        transition: opacity .2s;
    }

    /* Mouse-over effects */
    .slider:hover {
        opacity: 1;
        /* Fully shown on mouse-over */
    }

    .slider2:hover {
        opacity: 1;
        /* Fully shown on mouse-over */
    }

    /* The slider handle (use webkit (Chrome, Opera, Safari, Edge) and moz (Firefox) to override default look) */
    .slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        /* Override default look */
        appearance: none;
        width: 25px;
        /* Set a specific slider handle width */
        height: 25px;
        /* Slider handle height */
        background: #ffffff;
        /* Green background */
        border: 2px solid #5ca6ee;
        cursor: pointer;
        /* Cursor on hover */
    }

    .slider::-moz-range-thumb {
        width: 25px;
        /* Set a specific slider handle width */
        height: 25px;
        /* Slider handle height */
        background: #ffffff;
        /* Green background */
        border: 2px solid #5ca6ee;
        cursor: pointer;
        /* Cursor on hover */
    }

    .slider2::-webkit-slider-thumb {
        -webkit-appearance: none;
        /* Override default look */
        appearance: none;
        width: 25px;
        /* Set a specific slider handle width */
        height: 25px;
        /* Slider handle height */
        background: #ffffff;
        /* Green background */
        border: 2px solid #0fec00;
        cursor: pointer;
        /* Cursor on hover */
    }

    .slider2::-moz-range-thumb {
        width: 25px;
        /* Set a specific slider handle width */
        height: 25px;
        /* Slider handle height */
        background: #ffffff;
        /* Green background */
        border: 2px solid #0fec00;
        cursor: pointer;
        /* Cursor on hover */
    }

    #overlay {
        position: fixed; /* Sit on top of the page content */
        display: none; /* Hidden by default */
        width: 100%; /* Full width (cover the whole page) */
        height: 100%; /* Full height (cover the whole page) */
        top: 0; 
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0,0,0,0.5); /* Black background with opacity */
        z-index: 2; /* Specify a stack order in case you're using a different order for other elements */
        cursor: pointer; /* Add a pointer on hover */
    }
    #overlaytext{
        position: absolute;
        top: 50%;
        left: 50%;
        font-size: 20px;
        color: white;
        transform: translate(-50%,-50%);
        -ms-transform: translate(-50%,-50%);
    }
    fieldset {
        padding: 10px;
        background: #fbfbfb;
        border-radius: 5px;
        margin-bottom: 5px;
    }
</style>
<body>
<script src="https://code.jquery.com/jquery-3.3.1.js"
        integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>




<div class="row col-xs-12 col-md-12">
<div class="panel panel-primary">
<h3 class="panel-heading"><strong><span style="color: #1E1518;">Rating Chatbot Responses</span></strong></h3>

<p class="instr">Welcome! Thank you for participating in this task. Please read the instructions carefully, <strong>as they have changed</strong> .</p>

<p class="instr">You will see a snippet of a converation between a human user and a chatbot below. 
    This chatbot, named <strong>Svenbot</strong>, is supposed to help the user with their calendar.
    Here's the thing: Svenbot recently learned English, and isn't very confident yet.
    Often, it understands the user just fine, but still asks for clarification.
    Occasionally, it has trouble understanding the user, and even a little difference in how something is said 
    can change how Svenbot understands the user. 
    If Svenbot asks for clarification, that means it want to hear the instructions in a different way. 
    Pick the option that seems closest to what the user originally said.
</p>

<p class="instr">Your task is to evaluate whether any of the options given by Svenbot is a valid rephrasing of what the user told it to do. 
    If one of the options is valid, please select it and press submit.</p>

<p class="instr">You can click the buttons or use the number keys (1,2,3,4) to select options. 
    Note that you may have to click the HIT once to get the numbers to work, and clicking on the text box
    will disable the numbers (options can still be clicked with the mouse).</p>

<p class="instr">There may be multiple similar options. 
    Try to pick the one that most closely matches the original while still sounding natural. 
    If there are identical correct options, you can pick any one of them.</p>

<p class="instr">If none of the options proposed by Svenbot match what you think the user wanted, 
    then please use the textbox to rephrase what you think the user meant. 
    Try to rephrase it in a way you think Svenbot would understand.</p>

<p class="instr">If you have any questions or comments, please use the comment box, or send an e-mail to 
    <strong>textual.choreography@gmail.com</strong></p>

<p class="instr">Otherwise, please leave the comment box blank.</p>


<div hidden>
    <input id="is_checkmark_page" type="hidden" value="${is_checkmark_page}" /> 
    <input id="user_turn_0" type="hidden" value="${user_turn_0}" /> 
    <input id="agent_turn_0" type="hidden" value="${agent_turn_0}" /> 
</div>

<section>
<fieldset>
<script type="text/javascript">
    // document.getElementById("overlay").style.display === "block"){
    if (document.getElementById("is_checkmark_page").value === "true"){
        document.write("<div id=\"overlay\" onclick=\"off()\">" +
            "<div id=\"overlaytext\" >The following task looks similar to a separate HIT that you have completed in the past few days. "+
            "However, this round of tasks is different. Please read the new instructions carefully, and " +
            "click anywhere to confirm that you have read this message." +  
            "(This message will appear on each assignment in this HIT; all assignments in this HIT have the same instructions)" +
            "</div>" +
        "</div>");
        on();
            // "<button onclick=\"off()\"> Confirm </button>" +
        // set value so that it doesn't show up again  
        document.getElementById("is_checkmark_page").value = "false";
        function on(){
            document.getElementById("overlay").style.display = "block";
        }

        function off(){
            document.getElementById("overlay").style.display = "none";
        }
    }
    if(document.getElementById("user_turn_0")){
        if(document.getElementById("user_turn_0").value!== ""){
        document.write("<p class=\"user\"><strong> User: </strong> ${user_turn_0} </p>");
        document.write("<p class=\"chat\"><strong> Svenbot: </strong> ${agent_turn_0}</p>");

        }
    } 

</script>
<p class="user"><strong>User:</strong> <i> ${user_turn_1} </i></p>
<p class="chat"><strong>Svenbot:</strong> I'm sorry, I didn't catch that. 
    Are any of these what you meant?</p>

<div id="outerbox">
    <span class="box">
            <input accesskey="1" data-key="Key1" id="button_0" name="radio-input" title="Alt+1" type="radio" value="1" /> 
            (1) <label for="button_0"> <i> ${option_0} </i> </label> 
    </span> 
    <br>
    <span class="box">
            <input accesskey="2" data-key="Key1" id="button_1" name="radio-input" title="Alt+1" type="radio" value="2" /> 
            (2) <label for="button_1"> <i> ${option_1} </i> </label> 
    </span>
    <br>
    <span class="box">
            <input accesskey="3" data-key="Key1" id="button_2" name="radio-input" title="Alt+1" type="radio" value="3" /> 
            (3) <label for="button_2"> <i> ${option_2} </i> </label> 
    </span> 
    <br>
    <span class="box">
            <input accesskey="4" data-key="Key1" id="button_3" name="radio-input" title="Alt+1" type="radio" value="4" /> 
            (4) <label for="button_3"> <i> ${option_3} </i> </label> 
    </span> 
</div>
</fieldset>

</section>
</div>

<div class="form-group"><label for="comments">None of the above:</label> <input class="form-control" id="manual_entry" name="manual_entry" placeholder="Rephrase '${user_turn_1}'" type="text" /></div>
<div class="form-group"><label for="comments">Comments:</label> <input class="form-control" id="comments" name="comments" placeholder="" type="text" /></div>
</div>
</section>

<div hidden>
    <input id="option_0_idx" type="hidden" value="${option_0_idx}" /> 
    <input id="option_1_idx" type="hidden" value="${option_1_idx}" /> 
    <input id="option_2_idx" type="hidden" value="${option_2_idx}" /> 
    <input id="option_3_idx" type="hidden" value="${option_3_idx}" /> 
</div>

<script type="text/javascript">
    const controller = new AbortController();


    window.addEventListener("keypress", myEventHandler,  {signal: controller.signal});
    // el.addEventListener("keypress", myEventHandler, false);
    const el = document.getElementById("manual_entry");
    el.addEventListener("click", interruptHandler, false)

    function interruptHandler(e) {
        controller.abort();
    }

    function myEventHandler(e){
        var code = (e.keyCode ? e.keyCode : e.which);
        switch (code) {
            case 49: // 1
                $('#button_0').prop('checked', true);
                break;
            case 50: // 2
                $('#button_1').prop('checked', true);
                break;
            case 51: // 3
                $('#button_2').prop('checked', true);
                break;
            case 52: // 4
                $('#button_3').prop('checked', true);
                break;
        }
    }

</script>
</body>
